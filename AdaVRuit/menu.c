#include "menu.h"

/*
* Funktion:         twinkelLeftCursor()
* Beschreibung:     Schaltet die LEDs des linken Cursors aus
*/
void twinkelLeftCursor()
{
			printBit(1, 2, LED_OFF);
		printBit(2, 1, LED_OFF); printBit(2, 2, LED_OFF);
	printBit(3, 0, LED_OFF);printBit(3, 1, LED_OFF);
	printBit(4, 0, LED_OFF);printBit(4, 1, LED_OFF);
		printBit(5, 1, LED_OFF); printBit(5, 2, LED_OFF);
			printBit(6, 2, LED_OFF);
}

/*
* Funktion:         twinkelRightCursor()
* Beschreibung:     Schaltet die LEDs des rechten Cursors aus
*/
void twinkelRightCursor()
{
	printBit(1, 13, LED_OFF);
		printBit(2, 13, LED_OFF); printBit(2, 14, LED_OFF);
			printBit(3, 14, LED_OFF); printBit(3, 15, LED_OFF);
			printBit(4, 14, LED_OFF); printBit(4, 15, LED_OFF);
		printBit(5, 13, LED_OFF); printBit(5, 14, LED_OFF);
	printBit(6, 13, LED_OFF);
}

/*
* Funktion:         menu()
* Beschreibung:     Gibt ein Men� aus. Mit den "left"- und "right"-Tastern von Player 1 l�sst sich durch verschiedene
					Men�punkte bl�ttern. Die Men�punkte sind animiert und stellen das zu erwartende Spiel dar.
					Durch Dr�cken des "up"-Tasters von Player 1 wird der aktuelle Men�punkt gestartet.
*/

void menu()
{
	//Initialisierung aller Variablen

	uint8_t currentSelection = 1, counter = 0;

	uint8_t maxAnimationSteps[MENU_ENTRIES] = { 6, 14, 11 };

	struct animationData
	{
		uint16_t matrix[8];
	};

	
	/*/
	//Die struct-Arrays enthalten jeweils alle Einzelbilder der Animation,
	//eine Zeile entspricht einem Bild.
	/*/

	struct animationData pong[6] =
	{
		{
			0b0000000000000000,
			0b0010000000000100,
			0b0110010000000110,
			0b1100011000100011,
			0b1100010000100011,
			0b0110000000100110,
			0b0010000000000100,
			0b0000000000000000
			
		},
		{
			0b0000000000000000,
			0b0010000000000100,
			0b0110010000000110,
			0b1100010100100011,
			0b1100010000100011,
			0b0110000000100110,
			0b0010000000000100,
			0b0000000000000000

		},
		{
			0b0000000000000000,
			0b0010000000000100,
			0b0110010000000110,
			0b1100010010100011,
			0b1100010000100011,
			0b0110000000100110,
			0b0010000000000100,
			0b0000000000000000

		},
		{
			0b0000000000000000,
			0b0010000000000100,
			0b0110010000000110,
			0b1100010001100011,
			0b1100010000100011,
			0b0110000000100110,
			0b0010000000000100,
			0b0000000000000000

		},
		{
			0b0000000000000000,
			0b0010000000000100,
			0b0110010000000110,
			0b1100010010100011,
			0b1100010000100011,
			0b0110000000100110,
			0b0010000000000100,
			0b0000000000000000

		},
		{
			0b0000000000000000,
			0b0010000000000100,
			0b0110010000000110,
			0b1100010100100011,
			0b1100010000100011,
			0b0110000000100110,
			0b0010000000000100,
			0b0000000000000000
		}
	};

	struct animationData snake[14] =
	{
		{
			0b0000000000000000,
			0b0010000000000100,
			0b0110011100000110,
			0b1100000000000011,
			0b1100000000000011,
			0b0110000010000110,
			0b0010000000000100,
			0b0000000000000000
		},
		{
			0b0000000000000000,
			0b0010000000000100,
			0b0110011000000110,
			0b1100010000000011,
			0b1100000000000011,
			0b0110000010000110,
			0b0010000000000100,
			0b0000000000000000
		},
		{
			0b0000000000000000,
			0b0010000000000100,
			0b0110010000000110,
			0b1100010000000011,
			0b1100010000000011,
			0b0110000010000110,
			0b0010000000000100,
			0b0000000000000000
		},
		{
			0b0000000000000000,
			0b0010000000000100,
			0b0110000000000110,
			0b1100010000000011,
			0b1100010000000011,
			0b0110010010000110,
			0b0010000000000100,
			0b0000000000000000
		},
		{
			0b0000000000000000,
			0b0010000000000100,
			0b0110000000000110,
			0b1100000000000011,
			0b1100010000000011,
			0b0110011010000110,
			0b0010000000000100,
			0b0000000000000000
		},
		{
			0b0000000000000000,
			0b0010000000000100,
			0b0110000000000110,
			0b1100000000000011,
			0b1100000000000011,
			0b0110011110000110,
			0b0010000000000100,
			0b0000000000000000
		},
		{
			0b0000000000000000,
			0b0010000000000100,
			0b0110000000000110,
			0b1100000000000011,
			0b1100000000000011,
			0b0110001110000110,
			0b0010000000000100,
			0b0000000000000000
		},
		{
			0b0000000000000000,
			0b0010000000000100,
			0b0110000000000110,
			0b1100000000000011,
			0b1100000000000011,
			0b0110000111000110,
			0b0010000000000100,
			0b0000000000000000
		},
		{
			0b0000000000000000,
			0b0010000000000100,
			0b0110000000000110,
			0b1100000000000011,
			0b1100000001000011,
			0b0110000011000110,
			0b0010000000000100,
			0b0000000000000000
		},
		{
			0b0000000000000000,
			0b0010000000000100,
			0b0110000000000110,
			0b1100000001000011,
			0b1100000001000011,
			0b0110000001000110,
			0b0010000000000100,
			0b0000000000000000
		},
		{
			0b0000000000000000,
			0b0010000000000100,
			0b0110000001000110,
			0b1100000001000011,
			0b1100000001000011,
			0b0110000000000110,
			0b0010000000000100,
			0b0000000000000000
		},
		{
			0b0000000000000000,
			0b0010000000000100,
			0b0110000011000110,
			0b1100000001000011,
			0b1100000000000011,
			0b0110000000000110,
			0b0010000000000100,
			0b0000000000000000
		},
		{
			0b0000000000000000,
			0b0010000000000100,
			0b0110000111000110,
			0b1100000000000011,
			0b1100000000000011,
			0b0110000000000110,
			0b0010000000000100,
			0b0000000000000000
		},
		{
			0b0000000000000000,
			0b0010000000000100,
			0b0110001110000110,
			0b1100000000000011,
			0b1100000000000011,
			0b0110000000000110,
			0b0010000000000100,
			0b0000000000000000
		}
	};

	struct animationData tetris[11] =
	{
		{
			0b0000000010000000,
			0b0010000010000100,
			0b0110000110000110,
			0b1100000000000011,
			0b1100010000000011,
			0b0110011000110110,
			0b0010111110110100,
			0b0000000000000000
		},
		{
			0b0000000000000000,
			0b0010000010000100,
			0b0110000010000110,
			0b1100000110000011,
			0b1100010000000011,
			0b0110011000110110,
			0b0010111110110100,
			0b0000000000000000
		},
		{
			0b0000000000000000,
			0b0010000000000100,
			0b0110001110000110,
			0b1100000010000011,
			0b1100010000000011,
			0b0110011000110110,
			0b0010111110110100,
			0b0000000000000000
		},
		{
			0b0000000000000000,
			0b0010000000000100,
			0b0110000000000110,
			0b1100001110000011,
			0b1100010010000011,
			0b0110011000110110,
			0b0010111110110100,
			0b0000000000000000
		},
		{
			0b0000000000000000,
			0b0010000000000100,
			0b0110000000000110,
			0b1100000111000011,
			0b1100010001000011,
			0b0110011000110110,
			0b0010111110110100,
			0b0000000000000000
		},
		{
			0b0000000000000000,
			0b0010000000000100,
			0b0110000000000110,
			0b1100000000000011,
			0b1100010111000011,
			0b0110011001110110,
			0b0010111110110100,
			0b0000000000000000
		},
		{
			0b0000000000000000,
			0b0010000000000100,
			0b0110000000000110,
			0b1100000000000011,
			0b1100010000000011,
			0b0110011111110110,
			0b0010111111110100,
			0b0000000000000000
		},
		{
			0b0000000000000000,
			0b0010000000000100,
			0b0110000000000110,
			0b1100000000000011,
			0b1100010000000011,
			0b0110011111110110,
			0b0010000000000100,
			0b0000000000000000
		},
		{
			0b0000000000000000,
			0b0010000000000100,
			0b0110000000000110,
			0b1100000000000011,
			0b1100010000000011,
			0b0110011111110110,
			0b0010111111110100,
			0b0000000000000000
		},
		{
			0b0000000000000000,
			0b0010000000000100,
			0b0110000000000110,
			0b1100000000000011,
			0b1100010000000011,
			0b0110011111110110,
			0b0010000000000100,
			0b0000000000000000
		},
		{
			0b0000000000000000,
			0b0010000000000100,
			0b0110000000000110,
			0b1100000000000011,
			0b1100010000000011,
			0b0110011111110110,
			0b0010111111110100,
			0b0000000000000000
		}
	};

	clearDisplay();      //Bildschirm komplett l�schen

	while (1)
	{
		switch (currentSelection)
		{
		case 1:
			printArray(pong[counter].matrix);
			if (ui_player1_U()) playPong();
			break;
		case 2:
			printArray(snake[counter].matrix);
			if (ui_player1_U()) playSnake();
			break;
		case 3:
			printArray(tetris[counter].matrix);
			if (ui_player1_U()) playTetris();
			break;
		default:
			clearDisplay();      //TODO: sinnvollen default-Wert �berlegen
			break;
		}

		/*/
		// Abfrage ob links- oder rechts-Taste gedr�ckt wurde und
		// entsprechend der aktuell angezeigt Men�punkt gewechselt werden muss
		/*/
		if (ui_player1_L() == 1)
		{
			currentSelection--;
			twinkelLeftCursor();
			if (currentSelection == 0) currentSelection = MENU_ENTRIES;
		}
		if (ui_player1_R() == 1)
		{
			currentSelection++;
			twinkelRightCursor();
			if (currentSelection > MENU_ENTRIES) currentSelection = 1;
		}

		counter++;              //Counter wird erh�ht um das n�chste Bild der Animation auszuw�hlen
		if (counter >= maxAnimationSteps[currentSelection - 1]) counter = 0;

		_delay_ms(300);
	}
}

