#include "menu.h"


/*
* Funktion:         menu()
* Beschreibung:     Gibt ein Men� aus. Mit den "left"- und "right"-Tastern von Player 1 l�sst sich durch verschiedene
Men�punkte bl�ttern. Die Men�punkte sind animiert und stellen das zu erwartende Spiel dar.
Durch Dr�cken des "up"-Tasters von Player 1 wird der aktuelle Men�punkt gestartet.
*/

void menu()
{
	//Initialisierung aller Variablen

	uint8_t currentSelection = 1, counter = 0;

	uint8_t maxAnimationSteps[MENU_ENTRIES] = { 6, 14, 4 };
	//const uint8_t zeros[8][2] = { 0 };


	struct animationData
	{
		uint16_t matrix[8];
	};

	/*/
	//Die struct-Arrays enthalten jeweils alle Einzelbilder der Animation,
	//eine Zeile entspricht einem Bild.
	/*/

	struct animationData pong[6] =
	{
		{
			0b0000000000000000,
			0b0000000000000000,
			0b0100010000000010,
			0b1000011000100001,
			0b0100010000100010,
			0b0000000000100000,
			0b0000000000000000,
			0b0000000000000000
			
		},
		{
			0b0000000000000000,
			0b0000000000000000,
			0b0100010000000010,
			0b1000010100100001,
			0b0100010000100010,
			0b0000000000100000,
			0b0000000000000000,
			0b0000000000000000

		},
		{
			0b0000000000000000,
			0b0000000000000000,
			0b0100010000000010,
			0b1000010010100001,
			0b0100010000100010,
			0b0000000000100000,
			0b0000000000000000,
			0b0000000000000000

		},
		{
			0b0000000000000000,
			0b0000000000000000,
			0b0100010000000010,
			0b1000010001100001,
			0b0100010000100010,
			0b0000000000100000,
			0b0000000000000000,
			0b0000000000000000

		},
		{
			0b0000000000000000,
			0b0000000000000000,
			0b0100010000000010,
			0b1000010010100001,
			0b0100010000100010,
			0b0000000000100000,
			0b0000000000000000,
			0b0000000000000000

		},
		{
			0b0000000000000000,
			0b0000000000000000,
			0b0100010000000010,
			0b1000010100100001,
			0b0100010000100010,
			0b0000000000100000,
			0b0000000000000000,
			0b0000000000000000
		}
	};

	struct animationData snake[14] =
	{
		{
			0b0000000000000000,
			0b0000000000000000,
			0b0100011100000010,
			0b1000000000000001,
			0b0100000000000010,
			0b0000000010000000,
			0b0000000000000000,
			0b0000000000000000
		},
		{
			0b0000000000000000,
			0b0000000000000000,
			0b0100011000000010,
			0b1000010000000001,
			0b0100000000000010,
			0b0000000010000000,
			0b0000000000000000,
			0b0000000000000000
		},
		{
			0b0000000000000000,
			0b0000000000000000,
			0b0100010000000010,
			0b1000010000000001,
			0b0100010000000010,
			0b0000000010000000,
			0b0000000000000000,
			0b0000000000000000
		},
		{
			0b0000000000000000,
			0b0000000000000000,
			0b0100000000000010,
			0b1000010000000001,
			0b0100010000000010,
			0b0000010010000000,
			0b0000000000000000,
			0b0000000000000000
		},
		{
			0b0000000000000000,
			0b0000000000000000,
			0b0100000000000010,
			0b1000000000000001,
			0b0100010000000010,
			0b0000011010000000,
			0b0000000000000000,
			0b0000000000000000
		},
		{
			0b0000000000000000,
			0b0000000000000000,
			0b0100000000000010,
			0b1000000000000001,
			0b0100000000000010,
			0b0000011110000000,
			0b0000000000000000,
			0b0000000000000000
		},
		{
			0b0000000000000000,
			0b0000000000000000,
			0b0100000000000010,
			0b1000000000000001,
			0b0100000000000010,
			0b0000001110000000,
			0b0000000000000000,
			0b0000000000000000
		},
		{
			0b0000000000000000,
			0b0000000000000000,
			0b0100000000000010,
			0b1000000000000001,
			0b0100000000000010,
			0b0000000111000000,
			0b0000000000000000,
			0b0000000000000000
		},
		{
			0b0000000000000000,
			0b0000000000000000,
			0b0100000000000010,
			0b1000000000000001,
			0b0100000001000010,
			0b0000000011000000,
			0b0000000000000000,
			0b0000000000000000
		},
		{
			0b0000000000000000,
			0b0000000000000000,
			0b0100000000000010,
			0b1000000001000001,
			0b0100000001000010,
			0b0000000001000000,
			0b0000000000000000,
			0b0000000000000000
		},
		{
			0b0000000000000000,
			0b0000000000000000,
			0b0100000001000010,
			0b1000000001000001,
			0b0100000001000010,
			0b0000000000000000,
			0b0000000000000000,
			0b0000000000000000
		},
		{
			0b0000000000000000,
			0b0000000000000000,
			0b0100000011000010,
			0b1000000001000001,
			0b0100000000000010,
			0b0000000000000000,
			0b0000000000000000,
			0b0000000000000000
		},
		{
			0b0000000000000000,
			0b0000000000000000,
			0b0100000111000010,
			0b1000000000000001,
			0b0100000000000010,
			0b0000000000000000,
			0b0000000000000000,
			0b0000000000000000
		},
		{
			0b0000000000000000,
			0b0000000000000000,
			0b0100001110000010,
			0b1000000000000001,
			0b0100000000000010,
			0b0000000000000000,
			0b0000000000000000,
			0b0000000000000000
		}
	};

	struct animationData exempel[4] =
	{
		{
			0b0000000000000000,
			0b0000001111000000,
			0b0100000000100010,
			0b1000000000100001,
			0b0100000000100010,
			0b0000000000100000,
			0b0000001111000000,
			0b0000000000000000
		},
		{
			0b0000000000000000,
			0b0000000000000000,
			0b0100010000100010,
			0b1000010000100001,
			0b0100010000100010,
			0b0000010000100000,
			0b0000001111000000,
			0b0000000000000000
		},
		{
			0b0000000000000000,
			0b0000001111000000,
			0b0100010000000010,
			0b1000010000000001,
			0b0100010000000010,
			0b0000010000000000,
			0b0000001111000000,
			0b0000000000000000
		},
		{
			0b0000000000000000,
			0b0000001111000000,
			0b0100010000100010,
			0b1000010000100001,
			0b0100010000100010,
			0b0000010000100000,
			0b0000000000000000,
			0b0000000000000000
		}
	};

	clearDisplay();      //Bildschirm komplett l�schen

	while (1)
	{
		switch (currentSelection)
		{
		case 1:
			printArray(pong[counter].matrix);
			if (ui_player1_U()) playPong();
			break;
		case 2:
			printArray(snake[counter].matrix);
			//if (ui_player1_U()) playSnake();
			break;
		case 3:
			printArray(exempel[counter].matrix);
			//if (ui_player1_U()) playExempel();
			break;
		default:
			clearDisplay();      //TODO: sinnvollen default-Wert �berlegen
			break;
		}

		/*/
		// Abfrage ob links- oder rechts-Taste gedr�ckt wurde und
		// entsprechend der aktuell angezeigt Men�punkt gewechselt werden muss
		/*/
		if (ui_player1_L() == 1)
		{
			currentSelection--;
			printBit(3, 2, LED_OFF);
			printBit(4, 1, LED_OFF);
			printBit(5, 2, LED_OFF);
			if (currentSelection == 0) currentSelection = MENU_ENTRIES;
		}
		if (ui_player1_R() == 1)
		{
			currentSelection++;
			printBit(3, 15, LED_OFF);
			printBit(4, 16, LED_OFF);
			printBit(5, 15, LED_OFF);
			if (currentSelection > MENU_ENTRIES) currentSelection = 1;
		}

		counter++;              //Counter wird erh�ht um das n�chste Bild der Animation auszuw�hlen
		if (counter >= maxAnimationSteps[currentSelection - 1]) counter = 0;

		_delay_ms(100);
	}
}

